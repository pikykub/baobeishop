<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Store Mobile</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* --- CSS ส่วนการตกแต่ง --- */
        :root { --primary: #1e3a8a; --bg: #f8fafc; --white: #ffffff; }
        body { font-family: sans-serif; background: var(--bg); margin: 0; padding-bottom: 50px; }
        .navbar { background: var(--primary); color: white; padding: 15px; display: flex; justify-content: space-between; sticky; top: 0; z-index: 100; }
        .container { padding: 15px; }
        .product-grid { display: grid; grid-template-columns: 1fr; gap: 15px; }
        .product-card { background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border: 1px solid #ddd; }
        .card-action { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; }
        
        /* Modal Popup */
        .modal-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); display:none; justify-content:center; align-items:center; z-index:1000; }
        .modal-content { background:white; padding:20px; border-radius:15px; width:90%; max-height:80vh; overflow-y:auto; }
        
        /* Form */
        .form-group { margin-bottom: 10px; }
        input[type="text"], input[type="email"], textarea { width: 100%; padding: 10px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 5px; }
        .btn-primary { background: var(--primary); color: white; border: none; padding: 12px; width: 100%; border-radius: 5px; margin-top: 10px; }
        .btn-secondary { background: #64748b; color: white; border: none; padding: 12px; width: 100%; border-radius: 5px; margin-top: 5px; }
    </style>
</head>
<body>

    <nav class="navbar">
        <div style="font-weight:bold">EMAIL STORE</div>
        <div onclick="toggleCart()" style="cursor:pointer">
            <i class="fas fa-shopping-cart"></i> ตะกร้า (<span id="cart-count">0</span>)
        </div>
    </nav>

    <div class="container" id="mainPage">
        <h2 style="text-align:center">รายการสินค้า</h2>
        <div class="product-grid" id="productGrid"></div>
    </div>

    <div class="modal-overlay" id="cartModal">
        <div class="modal-content">
            <h3>รายการในตะกร้า</h3>
            <div id="cartItems"></div>
            <hr>
            <p>รวมทั้งสิ้น: <span id="totalPrice">0</span> บาท</p>
            <button class="btn-primary" onclick="goToCheckout()">ไปหน้าสั่งซื้อ</button>
            <button class="btn-secondary" onclick="toggleCart()">กลับไปเลือกต่อ</button>
        </div>
    </div>

    <div class="container" id="checkoutPage" style="display:none;">
        <h3>ข้อมูลการสั่งซื้อ</h3>
        <form id="orderForm">
            <div class="form-group"><label>ชื่อผู้ซื้อ</label><input type="text" id="custName" required></div>
            <div class="form-group"><label>อีเมลรับของ</label><input type="email" id="custEmail" required></div>
            <div class="form-group"><label>ที่อยู่</label><textarea id="custAddr"></textarea></div>
            <button type="submit" class="btn-primary">ยืนยันและรับรหัสสั่งซื้อ</button>
        </form>
    </div>

    <script>
        const products = [
            { id: 1, name: "Gmail (คุณภาพ A)", price: 50 },
            { id: 2, name: "Outlook เก่า 1 ปี", price: 100 },
            { id: 3, name: "Hotmail สมัครใหม่", price: 25 }
        ];
        let cart = [];

        function renderProducts() {
            const grid = document.getElementById('productGrid');
            grid.innerHTML = products.map(p => `
                <div class="product-card">
                    <strong>${p.name}</strong><br>ราคา: ${p.price} บาท
                    <div class="card-action">
                        <label><input type="checkbox" onchange="updateCart(${p.id}, this)"> เลือก</label>
                        <input type="number" id="qty-${p.id}" value="1" min="1" style="width:50px" onchange="changeQty(${p.id})">
                    </div>
                </div>
            `).join('');
        }

        function updateCart(id, chk) {
            const qty = parseInt(document.getElementById('qty-'+id).value);
            if(chk.checked) {
                cart.push({...products.find(p => p.id === id), qty});
            } else {
                cart = cart.filter(i => i.id !== id);
            }
            document.getElementById('cart-count').innerText = cart.length;
        }

        function changeQty(id) {
            const item = cart.find(i => i.id === id);
            if(item) item.qty = parseInt(document.getElementById('qty-'+id).value);
            renderCartUI();
        }

        function toggleCart() {
            const m = document.getElementById('cartModal');
            m.style.display = (m.style.display === 'flex') ? 'none' : 'flex';
            renderCartUI();
        }

        function renderCartUI() {
            let total = 0;
            document.getElementById('cartItems').innerHTML = cart.map(i => {
                total += (i.price * i.qty);
                return `<p>${i.name} x ${i.qty} = ${i.price * i.qty} บ.</p>`;
            }).join('');
            document.getElementById('totalPrice').innerText = total;
        }

        function goToCheckout() {
            if(cart.length === 0) return alert("เลือกสินค้าก่อนครับ");
            document.getElementById('cartModal').style.display = 'none';
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('checkoutPage').style.display = 'block';
        }

                document.getElementById('orderForm').onsubmit = (e) => {
            e.preventDefault();
            const orderId = "EML-" + Date.now().toString().slice(-6);
            const total = document.getElementById('totalPrice').innerText;
            
            // ส่วนที่แสดงเลขบัญชี
            const bankDetails = `
                <div style="text-align:center; background:white; padding:20px; border-radius:15px; border:2px solid #1e3a8a;">
                    <h2 style="color:#22c55e;">สั่งซื้อสำเร็จ!</h2>
                    <p>รหัสสั่งซื้อ: <strong>${orderId}</strong></p>
                    <p>ยอดที่ต้องโอน: <strong style="color:red;">${total} บาท</strong></p>
                    <hr>
                    <p><strong>ธนาคารเกียรนาคินภัทร</strong></p>
                    <p>เลขบัญชี: <strong>201-2-01901-4</strong> </p>
                    <p>ชื่อบัญชี: <strong>จิตราภรณ์ จันทร</strong></p>
                    <p style="font-size:0.8rem; color:gray;">โอนแล้วแจ้งสลิปทางแชทนะครับ</p>
                    <button onclick="location.reload()" class="btn-primary">กลับหน้าหลัก</button>
                </div>
            `;
            document.getElementById('checkoutPage').innerHTML = bankDetails;
            
            // เก็บข้อมูลลงเครื่อง
            const data = { orderId, name: document.getElementById('custName').value, items: cart, total: total };
            localStorage.setItem(orderId, JSON.stringify(data));
        };


        renderProducts();
    </script>
</body>
</html>

