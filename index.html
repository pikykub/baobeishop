<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BAOBEI SHOP - PREMIUM STORE</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        :root { --main: #ff2d55; --bg: #fff5e6; --card-bg: #ffffff; --bank: #5d2e8e; --text: #2d3436; --line: #06C755; }
        * { box-sizing: border-box; }

        body { 
            font-family: 'Kanit', sans-serif; 
            margin: 0; 
            background: url('https://w0.peakpx.com/wallpaper/419/840/HD-wallpaper-dark-blue-galaxy-star-night-sky-background.jpg') no-repeat center center fixed;
            background-size: cover;
            color: var(--text); 
            overflow-x: hidden; 
            min-height: 100vh;
        }

        .announcement { background: rgba(34, 34, 34, 0.9); color: #fff; padding: 10px; text-align: center; font-size: 13px; font-weight: 300; position: relative; z-index: 10; }
        #snowCanvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }

        .navbar { background: rgba(255, 255, 255, 0.95); padding: 10px 5%; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 15px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 1000; backdrop-filter: blur(5px); }
        .logo { font-size: 22px; font-weight: bold; color: var(--main); cursor: pointer; }
        .nav-right { display: flex; gap: 10px; align-items: center; }
        
        .btn-contact { background: #eee; color: #555; padding: 8px 15px; border-radius: 50px; text-decoration: none; font-size: 14px; font-weight: 500; transition: 0.3s; display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; }
        .btn-contact:hover { background: var(--line); color: white; transform: scale(1.1); }
        
        .balance-tag { background: var(--main); color: white; padding: 8px 20px; border-radius: 50px; font-weight: bold; cursor: pointer; transition: 0.3s; box-shadow: 0 4px 10px rgba(255, 45, 85, 0.3); }
        .btn-admin { background: #333; color: gold; padding: 8px 15px; border-radius: 50px; font-size: 14px; font-weight: bold; display: none; cursor: pointer; border: none; }

        .container { max-width: 1200px; margin: 40px auto; padding: 0 20px; position: relative; z-index: 5; }
        .title-bar { border-left: 6px solid var(--main); padding-left: 15px; margin-bottom: 35px; background: rgba(255, 255, 255, 0.85); border-radius: 0 10px 10px 0; display: inline-block; padding-right: 20px; }

        .banner-container { width: 100%; margin-bottom: 30px; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 25px rgba(0,0,0,0.15); }
        .banner-img { width: 100%; height: auto; display: block; object-fit: cover; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 30px; }
        .stat-box { background: rgba(26, 26, 26, 0.85); color: white; padding: 20px; border-radius: 15px; text-align: center; backdrop-filter: blur(5px); border: 1px solid rgba(255,255,255,0.1); }
        .stat-label { font-size: 12px; color: #aaa; text-transform: uppercase; }
        .stat-value { font-size: 24px; font-weight: bold; }

        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 25px; }
        .product-card { background: rgba(255,255,255,0.9); border-radius: 20px; overflow: hidden; box-shadow: 0 5px 20px rgba(0,0,0,0.1); text-align: center; }
        .product-img { width: 100%; height: 180px; object-fit: contain; padding: 20px; }
        .product-info { padding: 15px; background: #fff; }
        .btn-buy { background: var(--main); color: white; border: none; width: 100%; padding: 12px; border-radius: 12px; font-weight: bold; cursor: pointer; }
        .btn-buy:disabled { background: #ccc; }

        /* Chat System */
        .chat-widget { position: fixed; bottom: 100px; right: 30px; width: 320px; height: 400px; background: white; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); display: flex; flex-direction: column; overflow: hidden; z-index: 2500; transition: 0.4s; transform: translateY(20px); opacity: 0; pointer-events: none; }
        .chat-widget.active { transform: translateY(0); opacity: 1; pointer-events: auto; }
        .chat-header { background: var(--main); color: white; padding: 15px; font-weight: bold; display: flex; justify-content: space-between; }
        .chat-messages { flex: 1; padding: 15px; overflow-y: auto; background: #f9f9f9; display: flex; flex-direction: column; gap: 8px; }
        .msg { padding: 8px 12px; border-radius: 15px; max-width: 85%; font-size: 13px; line-height: 1.4; position: relative; }
        .msg-sender { font-size: 10px; font-weight: bold; display: block; margin-bottom: 2px; opacity: 0.6; }
        .msg-user { background: var(--main); color: white; align-self: flex-end; border-bottom-right-radius: 2px; }
        .msg-other { background: #e9e9eb; color: #333; align-self: flex-start; border-bottom-left-radius: 2px; }
        .msg-admin-text { background: #333 !important; color: gold !important; }

        .floating-chat { position: fixed; bottom: 30px; right: 30px; background: var(--line); color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 30px; cursor: pointer; z-index: 2000; box-shadow: 0 10px 25px rgba(6, 199, 85, 0.4); }

        .hidden { display: none !important; }
        .topup-card { background: white; padding: 30px; border-radius: 25px; text-align: center; max-width: 500px; margin: 0 auto; }
        .login-card { background: white; padding: 40px; border-radius: 25px; width: 90%; max-width: 400px; text-align: center; }
        .login-input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 10px; font-family: 'Kanit'; }
        
        #loginPage, #registerPage { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 3000; backdrop-filter: blur(5px); }
    </style>
</head>
<body>
    <canvas id="snowCanvas"></canvas>

    <div id="registerPage" class="hidden">
        <div class="login-card">
            <h2 style="color: var(--main);">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h2>
            <input type="text" id="regUsername" class="login-input" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">
            <input type="password" id="regPassword" class="login-input" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
            <button class="btn-buy" onclick="handleRegister()">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</button>
            <p style="font-size: 14px; margin-top: 15px;">‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏•‡πâ‡∏ß? <a href="#" onclick="toggleAuth('login')" style="color: var(--main);">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a></p>
        </div>
    </div>

    <div id="loginPage">
        <div class="login-card">
            <h2 style="color: var(--main);">BAOBEI LOGIN</h2>
            <input type="text" id="loginUsername" class="login-input" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">
            <input type="password" id="loginPassword" class="login-input" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
            <button class="btn-buy" onclick="handleLogin()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
            <p style="font-size: 14px; margin-top: 15px;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ? <a href="#" onclick="toggleAuth('register')" style="color: var(--main);">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</a></p>
        </div>
    </div>

    <div id="shopContent" class="hidden">
        <div class="announcement">‚ú® ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà BAOBEI SHOP | ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏î‡∏π‡πÅ‡∏• 24 ‡∏ä‡∏°. ‚ú®</div>
        <nav class="navbar">
            <div class="logo" onclick="showPage('home')">BAOBEI SHOP</div>
            <div class="nav-right">
                <button id="adminBtn" class="btn-admin" onclick="openAdminPanel()"><i class="fas fa-user-shield"></i> ADMIN</button>
                <div class="balance-tag" onclick="showPage('topup')"><i class="fas fa-wallet"></i> <span id="balanceDisplay">0</span> ‡∏ø</div>
                <a href="#" onclick="location.reload()" class="btn-contact"><i class="fas fa-sign-out-alt"></i></a>
            </div>
        </nav>

        <div class="container">
            <div id="homePage">
                <div class="banner-container">
                    <img src="https://img.freepik.com/free-vector/modern-sale-banner-with-abstract-gradient-shapes_23-2148411516.jpg" class="banner-img">
                </div>

                <div class="stats-grid">
                    <div class="stat-box">
                        <div class="stat-label">‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                        <div class="stat-value" id="statStock">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°</div>
                        <div class="stat-value" id="statSales">1,089</div>
                    </div>
                </div>
                
                <div class="title-bar"><h2><i class="fas fa-shopping-bag"></i> ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h2></div>
                <div id="productList" class="product-grid"></div>
            </div>

            <div id="topupPage" class="hidden">
                <div class="topup-card">
                    <h3>‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</h3>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 15px; margin-bottom: 20px; border: 1px dashed #ccc;">
                        <p><b>‡∏Å‡∏™‡∏¥‡∏Å‡∏£‡πÑ‡∏ó‡∏¢:</b> 201-201-9014 (‡∏à‡∏¥‡∏ï‡∏£‡∏≤‡∏†‡∏£‡∏ì‡πå)</p>
                        <p><b>Wallet:</b> 080-920-0932</p>
                    </div>
                    <input type="number" id="topupAmount" class="login-input" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô">
                    <button class="btn-buy" onclick="submitTopup()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏≠‡∏ô</button>
                    <p onclick="showPage('home')" style="cursor:pointer; margin-top:20px; color:gray;">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</p>
                </div>
            </div>
        </div>
    </div>

    <div class="chat-widget" id="chatBox">
        <div class="chat-header">
            <span><i class="fas fa-comments"></i> ‡πÅ‡∏ä‡∏ó‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</span>
            <i class="fas fa-times" style="cursor:pointer" onclick="toggleChat()"></i>
        </div>
        <div class="chat-messages" id="chatMessages"></div>
        <div style="padding: 10px; border-top: 1px solid #eee; display: flex; gap: 5px;">
            <input type="text" id="chatInput" style="flex:1; border: 1px solid #ddd; padding: 8px 12px; border-radius: 20px; outline:none;" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà...">
            <button onclick="sendChatMsg()" style="background: var(--main); color:white; border:none; width: 35px; height: 35px; border-radius: 50%; cursor:pointer;"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>
    <div class="floating-chat" onclick="toggleChat()"><i class="fas fa-comment-dots"></i></div>

    <script>
        // --- State Management ---
        const PRODUCTS = [
            { id: 1, name: "Email Thai (‡∏ï‡∏¥‡∏î‡∏™‡∏¥‡∏ó)", price: 15 },
            { id: 2, name: "Email Thai (‡πÇ‡∏ô‡πÅ‡∏û‡∏Ñ)", price: 18 },
            { id: 3, name: "Email ‡∏ô‡∏≠‡∏Å (‡∏ï‡∏¥‡∏î‡∏™‡∏¥‡∏ó)", price: 10 },
            { id: 4, name: "Email ‡∏ô‡∏≠‡∏Å (‡πÇ‡∏ô‡πÅ‡∏û‡∏Ñ)", price: 12 }
        ];

        let state = {
            users: JSON.parse(localStorage.getItem('bb_users')) || {},
            inventory: JSON.parse(localStorage.getItem('bb_inv')) || { 1: ["CODE-A1"], 2: ["CODE-B2"], 3: ["CODE-C3"], 4: ["CODE-D4"] },
            messages: JSON.parse(localStorage.getItem('bb_chats')) || [],
            currentUser: null,
            isAdmin: false
        };

        // --- Auth ---
        function toggleAuth(type) {
            document.getElementById('loginPage').classList.toggle('hidden', type !== 'login');
            document.getElementById('registerPage').classList.toggle('hidden', type !== 'register');
        }

        function handleRegister() {
            const u = document.getElementById('regUsername').value.trim();
            const p = document.getElementById('regPassword').value.trim();
            if(!u || !p) return Swal.fire('‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö', 'warning');
            if(state.users[u]) return Swal.fire('‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß', 'error');
            state.users[u] = { password: p, balance: 0 };
            save();
            Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß', 'success').then(() => toggleAuth('login'));
        }

        function handleLogin() {
            const u = document.getElementById('loginUsername').value.trim();
            const p = document.getElementById('loginPassword').value.trim();
            
            if(u === 'admin' && p === 'admin123') {
                state.currentUser = 'Admin';
                state.isAdmin = true;
            } else if(state.users[u] && state.users[u].password === p) {
                state.currentUser = u;
                state.isAdmin = false;
            } else {
                return Swal.fire('‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'error');
            }

            document.getElementById('loginPage').classList.add('hidden');
            document.getElementById('shopContent').classList.remove('hidden');
            if(state.isAdmin) document.getElementById('adminBtn').style.display = 'block';
            updateUI();
            renderMessages();
        }

        // --- UI & Actions ---
        function updateUI() {
            if(!state.isAdmin) document.getElementById('balanceDisplay').innerText = state.users[state.currentUser].balance.toLocaleString();
            
            let total = 0;
            Object.values(state.inventory).forEach(list => total += list.length);
            document.getElementById('statStock').innerText = total;

            const list = document.getElementById('productList');
            list.innerHTML = PRODUCTS.map(p => {
                const stock = state.inventory[p.id].length;
                return `
                <div class="product-card">
                    <img src="https://cdn-icons-png.flaticon.com/512/281/281769.png" class="product-img">
                    <div class="product-info">
                        <div style="font-weight:bold">${p.name}</div>
                        <div style="color:var(--main); font-size:18px; margin:10px 0;">${p.price} ‡∏ø</div>
                        <div style="font-size:12px; color:gray; margin-bottom:10px;">‡∏™‡∏ï‡πá‡∏≠‡∏Å: ${stock} ‡∏ä‡∏¥‡πâ‡∏ô</div>
                        <button class="btn-buy" onclick="buy(${p.id})" ${stock === 0 ? 'disabled' : ''}>
                            ${stock > 0 ? '‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤' : '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î'}
                        </button>
                    </div>
                </div>`;
            }).join('');
        }

        function buy(id) {
            const p = PRODUCTS.find(x => x.id === id);
            const user = state.users[state.currentUser];
            if(!state.isAdmin && user.balance < p.price) return Swal.fire('‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠', 'warning');
            
            const code = state.inventory[id].pop();
            if(!state.isAdmin) user.balance -= p.price;
            save(); updateUI();
            Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', `‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠: <b>${code}</b>`, 'success');
        }

        function submitTopup() {
            Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏´‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 5 ‡∏ô‡∏≤‡∏ó‡∏µ', 'success');
            showPage('home');
        }

        function showPage(p) {
            document.getElementById('homePage').classList.toggle('hidden', p !== 'home');
            document.getElementById('topupPage').classList.toggle('hidden', p !== 'topup');
        }

        // --- Chat Logic ---
        function toggleChat() { document.getElementById('chatBox').classList.toggle('active'); }

        function sendChatMsg() {
            const inp = document.getElementById('chatInput');
            if(!inp.value.trim()) return;

            const msg = {
                sender: state.currentUser,
                text: inp.value.trim(),
                isAdmin: state.isAdmin,
                time: new Date().toLocaleTimeString()
            };

            state.messages.push(msg);
            if(state.messages.length > 50) state.messages.shift();
            save();
            renderMessages();
            inp.value = '';
        }

        function renderMessages() {
            const container = document.getElementById('chatMessages');
            container.innerHTML = state.messages.map(m => `
                <div class="msg ${m.sender === state.currentUser ? 'msg-user' : 'msg-other'} ${m.isAdmin ? 'msg-admin-text' : ''}">
                    <span class="msg-sender">${m.isAdmin ? 'üëë ADMIN' : m.sender}</span>
                    ${m.text}
                </div>
            `).join('');
            container.scrollTop = container.scrollHeight;
        }

        // --- Admin Panel ---
        function openAdminPanel() {
            Swal.fire({
                title: '‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô',
                html: `
                    <div style="text-align:left;">
                        <p><b>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</b></p>
                        <select id="adm_id" class="swal2-input">${PRODUCTS.map(p=>`<option value="${p.id}">${p.name}</option>`)}</select>
                        <input id="adm_code" class="swal2-input" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤">
                        <hr>
                        <button onclick="clearAllChat()" class="btn-buy" style="background:#333">‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏ä‡∏ó‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                    </div>
                `,
                confirmButtonText: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ï‡πá‡∏≠‡∏Å',
                showCancelButton: true
            }).then(res => {
                if(res.isConfirmed) {
                    const id = document.getElementById('adm_id').value;
                    const code = document.getElementById('adm_code').value;
                    if(code) {
                        state.inventory[id].push(code);
                        save(); updateUI();
                        Swal.fire('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '', 'success');
                    }
                }
            });
        }

        window.clearAllChat = () => {
            state.messages = [];
            save();
            renderMessages();
            Swal.fire('‡∏•‡∏ö‡πÅ‡∏ä‡∏ó‡πÅ‡∏•‡πâ‡∏ß', '', 'success');
        };

        function save() {
            localStorage.setItem('bb_users', JSON.stringify(state.users));
            localStorage.setItem('bb_inv', JSON.stringify(state.inventory));
            localStorage.setItem('bb_chats', JSON.stringify(state.messages));
        }

        // Sync tabs
        window.onstorage = () => {
            state.messages = JSON.parse(localStorage.getItem('bb_chats')) || [];
            state.inventory = JSON.parse(localStorage.getItem('bb_inv')) || state.inventory;
            renderMessages();
            updateUI();
        };

        // Snow animation (simple)
        const canvas = document.getElementById('snowCanvas');
        const ctx = canvas.getContext('2d');
        let flakes = Array.from({length: 50}, () => ({ x: Math.random()*window.innerWidth, y: Math.random()*window.innerHeight, s: Math.random()*2+1 }));
        function draw() {
            ctx.clearRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle = "white";
            flakes.forEach(f => {
                ctx.beginPath(); ctx.arc(f.x, f.y, f.s, 0, Math.PI*2); ctx.fill();
                f.y += 1; if(f.y > canvas.height) f.y = 0;
            });
            requestAnimationFrame(draw);
        }
        window.onresize = () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; };
        window.onresize(); draw();
    </script>
</body>
</html>
